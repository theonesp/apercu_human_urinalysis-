---
title: "Apercu: 11_dataset_creation_and_exploration Nitrates"
author: Miguel √Ångel Armengol de la Hoz
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output:
  html_notebook:
    code_folding: hide
    number_sections: yes
    theme: flatly
    toc: yes
    toc_float: yes

knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_file = paste0(substr(inputFile,1,nchar(inputFile)-4)," ",Sys.Date(),'.html')) })
---

# Environment

```{r message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(data.table)
library(stringr)
library(reshape2)
library(sqldf)
library(readr)
library(plotly)
library(stringr)
library(caret)
library(magrittr)


```

# Data Load

## Proper column names

```{r}
proper_names<-c(
 'sample_id'
,'sampling_time'
,'SAMPLE_ID'
,'Bacteria'
,'Type_Bacteria'
,'CFU'
,'device_id'
,'location'
,'coords'
,'spectrum_740'
,'spectrum_741'
,'spectrum_742'
,'spectrum_743'
,'spectrum_744'
,'spectrum_745'
,'spectrum_746'
,'spectrum_747'
,'spectrum_748'
,'spectrum_749'
,'spectrum_750'
,'spectrum_751'
,'spectrum_752'
,'spectrum_753'
,'spectrum_754'
,'spectrum_755'
,'spectrum_756'
,'spectrum_757'
,'spectrum_758'
,'spectrum_759'
,'spectrum_760'
,'spectrum_761'
,'spectrum_762'
,'spectrum_763'
,'spectrum_764'
,'spectrum_765'
,'spectrum_766'
,'spectrum_767'
,'spectrum_768'
,'spectrum_769'
,'spectrum_770'
,'spectrum_771'
,'spectrum_772'
,'spectrum_773'
,'spectrum_774'
,'spectrum_775'
,'spectrum_776'
,'spectrum_777'
,'spectrum_778'
,'spectrum_779'
,'spectrum_780'
,'spectrum_781'
,'spectrum_782'
,'spectrum_783'
,'spectrum_784'
,'spectrum_785'
,'spectrum_786'
,'spectrum_787'
,'spectrum_788'
,'spectrum_789'
,'spectrum_790'
,'spectrum_791'
,'spectrum_792'
,'spectrum_793'
,'spectrum_794'
,'spectrum_795'
,'spectrum_796'
,'spectrum_797'
,'spectrum_798'
,'spectrum_799'
,'spectrum_800'
,'spectrum_801'
,'spectrum_802'
,'spectrum_803'
,'spectrum_804'
,'spectrum_805'
,'spectrum_806'
,'spectrum_807'
,'spectrum_808'
,'spectrum_809'
,'spectrum_810'
,'spectrum_811'
,'spectrum_812'
,'spectrum_813'
,'spectrum_814'
,'spectrum_815'
,'spectrum_816'
,'spectrum_817'
,'spectrum_818'
,'spectrum_819'
,'spectrum_820'
,'spectrum_821'
,'spectrum_822'
,'spectrum_823'
,'spectrum_824'
,'spectrum_825'
,'spectrum_826'
,'spectrum_827'
,'spectrum_828'
,'spectrum_829'
,'spectrum_830'
,'spectrum_831'
,'spectrum_832'
,'spectrum_833'
,'spectrum_834'
,'spectrum_835'
,'spectrum_836'
,'spectrum_837'
,'spectrum_838'
,'spectrum_839'
,'spectrum_840'
,'spectrum_841'
,'spectrum_842'
,'spectrum_843'
,'spectrum_844'
,'spectrum_845'
,'spectrum_846'
,'spectrum_847'
,'spectrum_848'
,'spectrum_849'
,'spectrum_850'
,'spectrum_851'
,'spectrum_852'
,'spectrum_853'
,'spectrum_854'
,'spectrum_855'
,'spectrum_856'
,'spectrum_857'
,'spectrum_858'
,'spectrum_859'
,'spectrum_860'
,'spectrum_861'
,'spectrum_862'
,'spectrum_863'
,'spectrum_864'
,'spectrum_865'
,'spectrum_866'
,'spectrum_867'
,'spectrum_868'
,'spectrum_869'
,'spectrum_870'
,'spectrum_871'
,'spectrum_872'
,'spectrum_873'
,'spectrum_874'
,'spectrum_875'
,'spectrum_876'
,'spectrum_877'
,'spectrum_878'
,'spectrum_879'
,'spectrum_880'
,'spectrum_881'
,'spectrum_882'
,'spectrum_883'
,'spectrum_884'
,'spectrum_885'
,'spectrum_886'
,'spectrum_887'
,'spectrum_888'
,'spectrum_889'
,'spectrum_890'
,'spectrum_891'
,'spectrum_892'
,'spectrum_893'
,'spectrum_894'
,'spectrum_895'
,'spectrum_896'
,'spectrum_897'
,'spectrum_898'
,'spectrum_899'
,'spectrum_900'
,'spectrum_901'
,'spectrum_902'
,'spectrum_903'
,'spectrum_904'
,'spectrum_905'
,'spectrum_906'
,'spectrum_907'
,'spectrum_908'
,'spectrum_909'
,'spectrum_910'
,'spectrum_911'
,'spectrum_912'
,'spectrum_913'
,'spectrum_914'
,'spectrum_915'
,'spectrum_916'
,'spectrum_917'
,'spectrum_918'
,'spectrum_919'
,'spectrum_920'
,'spectrum_921'
,'spectrum_922'
,'spectrum_923'
,'spectrum_924'
,'spectrum_925'
,'spectrum_926'
,'spectrum_927'
,'spectrum_928'
,'spectrum_929'
,'spectrum_930'
,'spectrum_931'
,'spectrum_932'
,'spectrum_933'
,'spectrum_934'
,'spectrum_935'
,'spectrum_936'
,'spectrum_937'
,'spectrum_938'
,'spectrum_939'
,'spectrum_940'
,'spectrum_941'
,'spectrum_942'
,'spectrum_943'
,'spectrum_944'
,'spectrum_945'
,'spectrum_946'
,'spectrum_947'
,'spectrum_948'
,'spectrum_949'
,'spectrum_950'
,'spectrum_951'
,'spectrum_952'
,'spectrum_953'
,'spectrum_954'
,'spectrum_955'
,'spectrum_956'
,'spectrum_957'
,'spectrum_958'
,'spectrum_959'
,'spectrum_960'
,'spectrum_961'
,'spectrum_962'
,'spectrum_963'
,'spectrum_964'
,'spectrum_965'
,'spectrum_966'
,'spectrum_967'
,'spectrum_968'
,'spectrum_969'
,'spectrum_970'
,'spectrum_971'
,'spectrum_972'
,'spectrum_973'
,'spectrum_974'
,'spectrum_975'
,'spectrum_976'
,'spectrum_977'
,'spectrum_978'
,'spectrum_979'
,'spectrum_980'
,'spectrum_981'
,'spectrum_982'
,'spectrum_983'
,'spectrum_984'
,'spectrum_985'
,'spectrum_986'
,'spectrum_987'
,'spectrum_988'
,'spectrum_989'
,'spectrum_990'
,'spectrum_991'
,'spectrum_992'
,'spectrum_993'
,'spectrum_994'
,'spectrum_995'
,'spectrum_996'
,'spectrum_997'
,'spectrum_998'
,'spectrum_999'
,'spectrum_1000'
,'spectrum_1001'
,'spectrum_1002'
,'spectrum_1003'
,'spectrum_1004'
,'spectrum_1005'
,'spectrum_1006'
,'spectrum_1007'
,'spectrum_1008'
,'spectrum_1009'
,'spectrum_1010'
,'spectrum_1011'
,'spectrum_1012'
,'spectrum_1013'
,'spectrum_1014'
,'spectrum_1015'
,'spectrum_1016'
,'spectrum_1017'
,'spectrum_1018'
,'spectrum_1019'
,'spectrum_1020'
,'spectrum_1021'
,'spectrum_1022'
,'spectrum_1023'
,'spectrum_1024'
,'spectrum_1025'
,'spectrum_1026'
,'spectrum_1027'
,'spectrum_1028'
,'spectrum_1029'
,'spectrum_1030'
,'spectrum_1031'
,'spectrum_1032'
,'spectrum_1033'
,'spectrum_1034'
,'spectrum_1035'
,'spectrum_1036'
,'spectrum_1037'
,'spectrum_1038'
,'spectrum_1039'
,'spectrum_1040'
,'spectrum_1041'
,'spectrum_1042'
,'spectrum_1043'
,'spectrum_1044'
,'spectrum_1045'
,'spectrum_1046'
,'spectrum_1047'
,'spectrum_1048'
,'spectrum_1049'
,'spectrum_1050'
,'spectrum_1051'
,'spectrum_1052'
,'spectrum_1053'
,'spectrum_1054'
,'spectrum_1055'
,'spectrum_1056'
,'spectrum_1057'
,'spectrum_1058'
,'spectrum_1059'
,'spectrum_1060'
,'spectrum_1061'
,'spectrum_1062'
,'spectrum_1063'
,'spectrum_1064'
,'spectrum_1065'
,'spectrum_1066'
,'spectrum_1067'
,'spectrum_1068'
,'spectrum_1069'
,'spectrum_1070'
,'wr_raw_740'
,'wr_raw_741'
,'wr_raw_742'
,'wr_raw_743'
,'wr_raw_744'
,'wr_raw_745'
,'wr_raw_746'
,'wr_raw_747'
,'wr_raw_748'
,'wr_raw_749'
,'wr_raw_750'
,'wr_raw_751'
,'wr_raw_752'
,'wr_raw_753'
,'wr_raw_754'
,'wr_raw_755'
,'wr_raw_756'
,'wr_raw_757'
,'wr_raw_758'
,'wr_raw_759'
,'wr_raw_760'
,'wr_raw_761'
,'wr_raw_762'
,'wr_raw_763'
,'wr_raw_764'
,'wr_raw_765'
,'wr_raw_766'
,'wr_raw_767'
,'wr_raw_768'
,'wr_raw_769'
,'wr_raw_770'
,'wr_raw_771'
,'wr_raw_772'
,'wr_raw_773'
,'wr_raw_774'
,'wr_raw_775'
,'wr_raw_776'
,'wr_raw_777'
,'wr_raw_778'
,'wr_raw_779'
,'wr_raw_780'
,'wr_raw_781'
,'wr_raw_782'
,'wr_raw_783'
,'wr_raw_784'
,'wr_raw_785'
,'wr_raw_786'
,'wr_raw_787'
,'wr_raw_788'
,'wr_raw_789'
,'wr_raw_790'
,'wr_raw_791'
,'wr_raw_792'
,'wr_raw_793'
,'wr_raw_794'
,'wr_raw_795'
,'wr_raw_796'
,'wr_raw_797'
,'wr_raw_798'
,'wr_raw_799'
,'wr_raw_800'
,'wr_raw_801'
,'wr_raw_802'
,'wr_raw_803'
,'wr_raw_804'
,'wr_raw_805'
,'wr_raw_806'
,'wr_raw_807'
,'wr_raw_808'
,'wr_raw_809'
,'wr_raw_810'
,'wr_raw_811'
,'wr_raw_812'
,'wr_raw_813'
,'wr_raw_814'
,'wr_raw_815'
,'wr_raw_816'
,'wr_raw_817'
,'wr_raw_818'
,'wr_raw_819'
,'wr_raw_820'
,'wr_raw_821'
,'wr_raw_822'
,'wr_raw_823'
,'wr_raw_824'
,'wr_raw_825'
,'wr_raw_826'
,'wr_raw_827'
,'wr_raw_828'
,'wr_raw_829'
,'wr_raw_830'
,'wr_raw_831'
,'wr_raw_832'
,'wr_raw_833'
,'wr_raw_834'
,'wr_raw_835'
,'wr_raw_836'
,'wr_raw_837'
,'wr_raw_838'
,'wr_raw_839'
,'wr_raw_840'
,'wr_raw_841'
,'wr_raw_842'
,'wr_raw_843'
,'wr_raw_844'
,'wr_raw_845'
,'wr_raw_846'
,'wr_raw_847'
,'wr_raw_848'
,'wr_raw_849'
,'wr_raw_850'
,'wr_raw_851'
,'wr_raw_852'
,'wr_raw_853'
,'wr_raw_854'
,'wr_raw_855'
,'wr_raw_856'
,'wr_raw_857'
,'wr_raw_858'
,'wr_raw_859'
,'wr_raw_860'
,'wr_raw_861'
,'wr_raw_862'
,'wr_raw_863'
,'wr_raw_864'
,'wr_raw_865'
,'wr_raw_866'
,'wr_raw_867'
,'wr_raw_868'
,'wr_raw_869'
,'wr_raw_870'
,'wr_raw_871'
,'wr_raw_872'
,'wr_raw_873'
,'wr_raw_874'
,'wr_raw_875'
,'wr_raw_876'
,'wr_raw_877'
,'wr_raw_878'
,'wr_raw_879'
,'wr_raw_880'
,'wr_raw_881'
,'wr_raw_882'
,'wr_raw_883'
,'wr_raw_884'
,'wr_raw_885'
,'wr_raw_886'
,'wr_raw_887'
,'wr_raw_888'
,'wr_raw_889'
,'wr_raw_890'
,'wr_raw_891'
,'wr_raw_892'
,'wr_raw_893'
,'wr_raw_894'
,'wr_raw_895'
,'wr_raw_896'
,'wr_raw_897'
,'wr_raw_898'
,'wr_raw_899'
,'wr_raw_900'
,'wr_raw_901'
,'wr_raw_902'
,'wr_raw_903'
,'wr_raw_904'
,'wr_raw_905'
,'wr_raw_906'
,'wr_raw_907'
,'wr_raw_908'
,'wr_raw_909'
,'wr_raw_910'
,'wr_raw_911'
,'wr_raw_912'
,'wr_raw_913'
,'wr_raw_914'
,'wr_raw_915'
,'wr_raw_916'
,'wr_raw_917'
,'wr_raw_918'
,'wr_raw_919'
,'wr_raw_920'
,'wr_raw_921'
,'wr_raw_922'
,'wr_raw_923'
,'wr_raw_924'
,'wr_raw_925'
,'wr_raw_926'
,'wr_raw_927'
,'wr_raw_928'
,'wr_raw_929'
,'wr_raw_930'
,'wr_raw_931'
,'wr_raw_932'
,'wr_raw_933'
,'wr_raw_934'
,'wr_raw_935'
,'wr_raw_936'
,'wr_raw_937'
,'wr_raw_938'
,'wr_raw_939'
,'wr_raw_940'
,'wr_raw_941'
,'wr_raw_942'
,'wr_raw_943'
,'wr_raw_944'
,'wr_raw_945'
,'wr_raw_946'
,'wr_raw_947'
,'wr_raw_948'
,'wr_raw_949'
,'wr_raw_950'
,'wr_raw_951'
,'wr_raw_952'
,'wr_raw_953'
,'wr_raw_954'
,'wr_raw_955'
,'wr_raw_956'
,'wr_raw_957'
,'wr_raw_958'
,'wr_raw_959'
,'wr_raw_960'
,'wr_raw_961'
,'wr_raw_962'
,'wr_raw_963'
,'wr_raw_964'
,'wr_raw_965'
,'wr_raw_966'
,'wr_raw_967'
,'wr_raw_968'
,'wr_raw_969'
,'wr_raw_970'
,'wr_raw_971'
,'wr_raw_972'
,'wr_raw_973'
,'wr_raw_974'
,'wr_raw_975'
,'wr_raw_976'
,'wr_raw_977'
,'wr_raw_978'
,'wr_raw_979'
,'wr_raw_980'
,'wr_raw_981'
,'wr_raw_982'
,'wr_raw_983'
,'wr_raw_984'
,'wr_raw_985'
,'wr_raw_986'
,'wr_raw_987'
,'wr_raw_988'
,'wr_raw_989'
,'wr_raw_990'
,'wr_raw_991'
,'wr_raw_992'
,'wr_raw_993'
,'wr_raw_994'
,'wr_raw_995'
,'wr_raw_996'
,'wr_raw_997'
,'wr_raw_998'
,'wr_raw_999'
,'wr_raw_1000'
,'wr_raw_1001'
,'wr_raw_1002'
,'wr_raw_1003'
,'wr_raw_1004'
,'wr_raw_1005'
,'wr_raw_1006'
,'wr_raw_1007'
,'wr_raw_1008'
,'wr_raw_1009'
,'wr_raw_1010'
,'wr_raw_1011'
,'wr_raw_1012'
,'wr_raw_1013'
,'wr_raw_1014'
,'wr_raw_1015'
,'wr_raw_1016'
,'wr_raw_1017'
,'wr_raw_1018'
,'wr_raw_1019'
,'wr_raw_1020'
,'wr_raw_1021'
,'wr_raw_1022'
,'wr_raw_1023'
,'wr_raw_1024'
,'wr_raw_1025'
,'wr_raw_1026'
,'wr_raw_1027'
,'wr_raw_1028'
,'wr_raw_1029'
,'wr_raw_1030'
,'wr_raw_1031'
,'wr_raw_1032'
,'wr_raw_1033'
,'wr_raw_1034'
,'wr_raw_1035'
,'wr_raw_1036'
,'wr_raw_1037'
,'wr_raw_1038'
,'wr_raw_1039'
,'wr_raw_1040'
,'wr_raw_1041'
,'wr_raw_1042'
,'wr_raw_1043'
,'wr_raw_1044'
,'wr_raw_1045'
,'wr_raw_1046'
,'wr_raw_1047'
,'wr_raw_1048'
,'wr_raw_1049'
,'wr_raw_1050'
,'wr_raw_1051'
,'wr_raw_1052'
,'wr_raw_1053'
,'wr_raw_1054'
,'wr_raw_1055'
,'wr_raw_1056'
,'wr_raw_1057'
,'wr_raw_1058'
,'wr_raw_1059'
,'wr_raw_1060'
,'wr_raw_1061'
,'wr_raw_1062'
,'wr_raw_1063'
,'wr_raw_1064'
,'wr_raw_1065'
,'wr_raw_1066'
,'wr_raw_1067'
,'wr_raw_1068'
,'wr_raw_1069'
,'wr_raw_1070'
,'sample_raw_740'
,'sample_raw_741'
,'sample_raw_742'
,'sample_raw_743'
,'sample_raw_744'
,'sample_raw_745'
,'sample_raw_746'
,'sample_raw_747'
,'sample_raw_748'
,'sample_raw_749'
,'sample_raw_750'
,'sample_raw_751'
,'sample_raw_752'
,'sample_raw_753'
,'sample_raw_754'
,'sample_raw_755'
,'sample_raw_756'
,'sample_raw_757'
,'sample_raw_758'
,'sample_raw_759'
,'sample_raw_760'
,'sample_raw_761'
,'sample_raw_762'
,'sample_raw_763'
,'sample_raw_764'
,'sample_raw_765'
,'sample_raw_766'
,'sample_raw_767'
,'sample_raw_768'
,'sample_raw_769'
,'sample_raw_770'
,'sample_raw_771'
,'sample_raw_772'
,'sample_raw_773'
,'sample_raw_774'
,'sample_raw_775'
,'sample_raw_776'
,'sample_raw_777'
,'sample_raw_778'
,'sample_raw_779'
,'sample_raw_780'
,'sample_raw_781'
,'sample_raw_782'
,'sample_raw_783'
,'sample_raw_784'
,'sample_raw_785'
,'sample_raw_786'
,'sample_raw_787'
,'sample_raw_788'
,'sample_raw_789'
,'sample_raw_790'
,'sample_raw_791'
,'sample_raw_792'
,'sample_raw_793'
,'sample_raw_794'
,'sample_raw_795'
,'sample_raw_796'
,'sample_raw_797'
,'sample_raw_798'
,'sample_raw_799'
,'sample_raw_800'
,'sample_raw_801'
,'sample_raw_802'
,'sample_raw_803'
,'sample_raw_804'
,'sample_raw_805'
,'sample_raw_806'
,'sample_raw_807'
,'sample_raw_808'
,'sample_raw_809'
,'sample_raw_810'
,'sample_raw_811'
,'sample_raw_812'
,'sample_raw_813'
,'sample_raw_814'
,'sample_raw_815'
,'sample_raw_816'
,'sample_raw_817'
,'sample_raw_818'
,'sample_raw_819'
,'sample_raw_820'
,'sample_raw_821'
,'sample_raw_822'
,'sample_raw_823'
,'sample_raw_824'
,'sample_raw_825'
,'sample_raw_826'
,'sample_raw_827'
,'sample_raw_828'
,'sample_raw_829'
,'sample_raw_830'
,'sample_raw_831'
,'sample_raw_832'
,'sample_raw_833'
,'sample_raw_834'
,'sample_raw_835'
,'sample_raw_836'
,'sample_raw_837'
,'sample_raw_838'
,'sample_raw_839'
,'sample_raw_840'
,'sample_raw_841'
,'sample_raw_842'
,'sample_raw_843'
,'sample_raw_844'
,'sample_raw_845'
,'sample_raw_846'
,'sample_raw_847'
,'sample_raw_848'
,'sample_raw_849'
,'sample_raw_850'
,'sample_raw_851'
,'sample_raw_852'
,'sample_raw_853'
,'sample_raw_854'
,'sample_raw_855'
,'sample_raw_856'
,'sample_raw_857'
,'sample_raw_858'
,'sample_raw_859'
,'sample_raw_860'
,'sample_raw_861'
,'sample_raw_862'
,'sample_raw_863'
,'sample_raw_864'
,'sample_raw_865'
,'sample_raw_866'
,'sample_raw_867'
,'sample_raw_868'
,'sample_raw_869'
,'sample_raw_870'
,'sample_raw_871'
,'sample_raw_872'
,'sample_raw_873'
,'sample_raw_874'
,'sample_raw_875'
,'sample_raw_876'
,'sample_raw_877'
,'sample_raw_878'
,'sample_raw_879'
,'sample_raw_880'
,'sample_raw_881'
,'sample_raw_882'
,'sample_raw_883'
,'sample_raw_884'
,'sample_raw_885'
,'sample_raw_886'
,'sample_raw_887'
,'sample_raw_888'
,'sample_raw_889'
,'sample_raw_890'
,'sample_raw_891'
,'sample_raw_892'
,'sample_raw_893'
,'sample_raw_894'
,'sample_raw_895'
,'sample_raw_896'
,'sample_raw_897'
,'sample_raw_898'
,'sample_raw_899'
,'sample_raw_900'
,'sample_raw_901'
,'sample_raw_902'
,'sample_raw_903'
,'sample_raw_904'
,'sample_raw_905'
,'sample_raw_906'
,'sample_raw_907'
,'sample_raw_908'
,'sample_raw_909'
,'sample_raw_910'
,'sample_raw_911'
,'sample_raw_912'
,'sample_raw_913'
,'sample_raw_914'
,'sample_raw_915'
,'sample_raw_916'
,'sample_raw_917'
,'sample_raw_918'
,'sample_raw_919'
,'sample_raw_920'
,'sample_raw_921'
,'sample_raw_922'
,'sample_raw_923'
,'sample_raw_924'
,'sample_raw_925'
,'sample_raw_926'
,'sample_raw_927'
,'sample_raw_928'
,'sample_raw_929'
,'sample_raw_930'
,'sample_raw_931'
,'sample_raw_932'
,'sample_raw_933'
,'sample_raw_934'
,'sample_raw_935'
,'sample_raw_936'
,'sample_raw_937'
,'sample_raw_938'
,'sample_raw_939'
,'sample_raw_940'
,'sample_raw_941'
,'sample_raw_942'
,'sample_raw_943'
,'sample_raw_944'
,'sample_raw_945'
,'sample_raw_946'
,'sample_raw_947'
,'sample_raw_948'
,'sample_raw_949'
,'sample_raw_950'
,'sample_raw_951'
,'sample_raw_952'
,'sample_raw_953'
,'sample_raw_954'
,'sample_raw_955'
,'sample_raw_956'
,'sample_raw_957'
,'sample_raw_958'
,'sample_raw_959'
,'sample_raw_960'
,'sample_raw_961'
,'sample_raw_962'
,'sample_raw_963'
,'sample_raw_964'
,'sample_raw_965'
,'sample_raw_966'
,'sample_raw_967'
,'sample_raw_968'
,'sample_raw_969'
,'sample_raw_970'
,'sample_raw_971'
,'sample_raw_972'
,'sample_raw_973'
,'sample_raw_974'
,'sample_raw_975'
,'sample_raw_976'
,'sample_raw_977'
,'sample_raw_978'
,'sample_raw_979'
,'sample_raw_980'
,'sample_raw_981'
,'sample_raw_982'
,'sample_raw_983'
,'sample_raw_984'
,'sample_raw_985'
,'sample_raw_986'
,'sample_raw_987'
,'sample_raw_988'
,'sample_raw_989'
,'sample_raw_990'
,'sample_raw_991'
,'sample_raw_992'
,'sample_raw_993'
,'sample_raw_994'
,'sample_raw_995'
,'sample_raw_996'
,'sample_raw_997'
,'sample_raw_998'
,'sample_raw_999'
,'sample_raw_1000'
,'sample_raw_1001'
,'sample_raw_1002'
,'sample_raw_1003'
,'sample_raw_1004'
,'sample_raw_1005'
,'sample_raw_1006'
,'sample_raw_1007'
,'sample_raw_1008'
,'sample_raw_1009'
,'sample_raw_1010'
,'sample_raw_1011'
,'sample_raw_1012'
,'sample_raw_1013'
,'sample_raw_1014'
,'sample_raw_1015'
,'sample_raw_1016'
,'sample_raw_1017'
,'sample_raw_1018'
,'sample_raw_1019'
,'sample_raw_1020'
,'sample_raw_1021'
,'sample_raw_1022'
,'sample_raw_1023'
,'sample_raw_1024'
,'sample_raw_1025'
,'sample_raw_1026'
,'sample_raw_1027'
,'sample_raw_1028'
,'sample_raw_1029'
,'sample_raw_1030'
,'sample_raw_1031'
,'sample_raw_1032'
,'sample_raw_1033'
,'sample_raw_1034'
,'sample_raw_1035'
,'sample_raw_1036'
,'sample_raw_1037'
,'sample_raw_1038'
,'sample_raw_1039'
,'sample_raw_1040'
,'sample_raw_1041'
,'sample_raw_1042'
,'sample_raw_1043'
,'sample_raw_1044'
,'sample_raw_1045'
,'sample_raw_1046'
,'sample_raw_1047'
,'sample_raw_1048'
,'sample_raw_1049'
,'sample_raw_1050'
,'sample_raw_1051'
,'sample_raw_1052'
,'sample_raw_1053'
,'sample_raw_1054'
,'sample_raw_1055'
,'sample_raw_1056'
,'sample_raw_1057'
,'sample_raw_1058'
,'sample_raw_1059'
,'sample_raw_1060'
,'sample_raw_1061'
,'sample_raw_1062'
,'sample_raw_1063'
,'sample_raw_1064'
,'sample_raw_1065'
,'sample_raw_1066'
,'sample_raw_1067'
,'sample_raw_1068'
,'sample_raw_1069'
,'sample_raw_1070'
)

proper_names<-make.names(proper_names)
```
my_new_file = current_file[-(1:11)]

```{r message=FALSE, warning=FALSE}
file_list <- list.files(path="../../data/set1_aug21march22/")


appended_series_set1<-data.frame()
for (i in file_list) {
  df_teberenamed<-read.csv(paste0('../../data/set1_aug21march22/',i),skip = 11)
  # intuitive naming
  names(df_teberenamed)<-proper_names
  #creating final outcome
  df_teberenamed %<>%mutate(bact = ifelse(Type_Bacteria == "Yes",'Pos','Neg'))
  assign(str_remove(i,'.csv'),df_teberenamed)
  appended_series_set1 <-rbind(appended_series_set1,df_teberenamed)
}


```

# Appending data

## Columns of interest

```{r}
selected_columns<-c(
'bact',
'spectrum_740',
'spectrum_741',
'spectrum_742',
'spectrum_743',
'spectrum_744',
'spectrum_745',
'spectrum_746',
'spectrum_747',
'spectrum_748',
'spectrum_749',
'spectrum_750',
'spectrum_751',
'spectrum_752',
'spectrum_753',
'spectrum_754',
'spectrum_755',
'spectrum_756',
'spectrum_757',
'spectrum_758',
'spectrum_759',
'spectrum_760',
'spectrum_761',
'spectrum_762',
'spectrum_763',
'spectrum_764',
'spectrum_765',
'spectrum_766',
'spectrum_767',
'spectrum_768',
'spectrum_769',
'spectrum_770',
'spectrum_771',
'spectrum_772',
'spectrum_773',
'spectrum_774',
'spectrum_775',
'spectrum_776',
'spectrum_777',
'spectrum_778',
'spectrum_779',
'spectrum_780',
'spectrum_781',
'spectrum_782',
'spectrum_783',
'spectrum_784',
'spectrum_785',
'spectrum_786',
'spectrum_787',
'spectrum_788',
'spectrum_789',
'spectrum_790',
'spectrum_791',
'spectrum_792',
'spectrum_793',
'spectrum_794',
'spectrum_795',
'spectrum_796',
'spectrum_797',
'spectrum_798',
'spectrum_799',
'spectrum_800',
'spectrum_801',
'spectrum_802',
'spectrum_803',
'spectrum_804',
'spectrum_805',
'spectrum_806',
'spectrum_807',
'spectrum_808',
'spectrum_809',
'spectrum_810',
'spectrum_811',
'spectrum_812',
'spectrum_813',
'spectrum_814',
'spectrum_815',
'spectrum_816',
'spectrum_817',
'spectrum_818',
'spectrum_819',
'spectrum_820',
'spectrum_821',
'spectrum_822',
'spectrum_823',
'spectrum_824',
'spectrum_825',
'spectrum_826',
'spectrum_827',
'spectrum_828',
'spectrum_829',
'spectrum_830',
'spectrum_831',
'spectrum_832',
'spectrum_833',
'spectrum_834',
'spectrum_835',
'spectrum_836',
'spectrum_837',
'spectrum_838',
'spectrum_839',
'spectrum_840',
'spectrum_841',
'spectrum_842',
'spectrum_843',
'spectrum_844',
'spectrum_845',
'spectrum_846',
'spectrum_847',
'spectrum_848',
'spectrum_849',
'spectrum_850',
'spectrum_851',
'spectrum_852',
'spectrum_853',
'spectrum_854',
'spectrum_855',
'spectrum_856',
'spectrum_857',
'spectrum_858',
'spectrum_859',
'spectrum_860',
'spectrum_861',
'spectrum_862',
'spectrum_863',
'spectrum_864',
'spectrum_865',
'spectrum_866',
'spectrum_867',
'spectrum_868',
'spectrum_869',
'spectrum_870',
'spectrum_871',
'spectrum_872',
'spectrum_873',
'spectrum_874',
'spectrum_875',
'spectrum_876',
'spectrum_877',
'spectrum_878',
'spectrum_879',
'spectrum_880',
'spectrum_881',
'spectrum_882',
'spectrum_883',
'spectrum_884',
'spectrum_885',
'spectrum_886',
'spectrum_887',
'spectrum_888',
'spectrum_889',
'spectrum_890',
'spectrum_891',
'spectrum_892',
'spectrum_893',
'spectrum_894',
'spectrum_895',
'spectrum_896',
'spectrum_897',
'spectrum_898',
'spectrum_899',
'spectrum_900',
'spectrum_901',
'spectrum_902',
'spectrum_903',
'spectrum_904',
'spectrum_905',
'spectrum_906',
'spectrum_907',
'spectrum_908',
'spectrum_909',
'spectrum_910',
'spectrum_911',
'spectrum_912',
'spectrum_913',
'spectrum_914',
'spectrum_915',
'spectrum_916',
'spectrum_917',
'spectrum_918',
'spectrum_919',
'spectrum_920',
'spectrum_921',
'spectrum_922',
'spectrum_923',
'spectrum_924',
'spectrum_925',
'spectrum_926',
'spectrum_927',
'spectrum_928',
'spectrum_929',
'spectrum_930',
'spectrum_931',
'spectrum_932',
'spectrum_933',
'spectrum_934',
'spectrum_935',
'spectrum_936',
'spectrum_937',
'spectrum_938',
'spectrum_939',
'spectrum_940',
'spectrum_941',
'spectrum_942',
'spectrum_943',
'spectrum_944',
'spectrum_945',
'spectrum_946',
'spectrum_947',
'spectrum_948',
'spectrum_949',
'spectrum_950',
'spectrum_951',
'spectrum_952',
'spectrum_953',
'spectrum_954',
'spectrum_955',
'spectrum_956',
'spectrum_957',
'spectrum_958',
'spectrum_959',
'spectrum_960',
'spectrum_961',
'spectrum_962',
'spectrum_963',
'spectrum_964',
'spectrum_965',
'spectrum_966',
'spectrum_967',
'spectrum_968',
'spectrum_969',
'spectrum_970',
'spectrum_971',
'spectrum_972',
'spectrum_973',
'spectrum_974',
'spectrum_975',
'spectrum_976',
'spectrum_977',
'spectrum_978',
'spectrum_979',
'spectrum_980',
'spectrum_981',
'spectrum_982',
'spectrum_983',
'spectrum_984',
'spectrum_985',
'spectrum_986',
'spectrum_987',
'spectrum_988',
'spectrum_989',
'spectrum_990',
'spectrum_991',
'spectrum_992',
'spectrum_993',
'spectrum_994',
'spectrum_995',
'spectrum_996',
'spectrum_997',
'spectrum_998',
'spectrum_999',
'spectrum_1000',
'spectrum_1001',
'spectrum_1002',
'spectrum_1003',
'spectrum_1004',
'spectrum_1005',
'spectrum_1006',
'spectrum_1007',
'spectrum_1008',
'spectrum_1009',
'spectrum_1010',
'spectrum_1011',
'spectrum_1012',
'spectrum_1013',
'spectrum_1014',
'spectrum_1015',
'spectrum_1016',
'spectrum_1017',
'spectrum_1018',
'spectrum_1019',
'spectrum_1020',
'spectrum_1021',
'spectrum_1022',
'spectrum_1023',
'spectrum_1024',
'spectrum_1025',
'spectrum_1026',
'spectrum_1027',
'spectrum_1028',
'spectrum_1029',
'spectrum_1030',
'spectrum_1031',
'spectrum_1032',
'spectrum_1033',
'spectrum_1034',
'spectrum_1035',
'spectrum_1036',
'spectrum_1037',
'spectrum_1038',
'spectrum_1039',
'spectrum_1040',
'spectrum_1041',
'spectrum_1042',
'spectrum_1043',
'spectrum_1044',
'spectrum_1045',
'spectrum_1046',
'spectrum_1047',
'spectrum_1048',
'spectrum_1049',
'spectrum_1050',
'spectrum_1051',
'spectrum_1052',
'spectrum_1053',
'spectrum_1054',
'spectrum_1055',
'spectrum_1056',
'spectrum_1057',
'spectrum_1058',
'spectrum_1059',
'spectrum_1060',
'spectrum_1061',
'spectrum_1062',
'spectrum_1063',
'spectrum_1064',
'spectrum_1065',
'spectrum_1066',
'spectrum_1067',
'spectrum_1068',
'spectrum_1069',
'spectrum_1070'
)
```

## Selecting only important variables

```{r}
appended_series_set1_selected<-appended_series_set1[,selected_columns]
```

# Train and test datasets creation

## Spliting de-identified data into testing and training, balanced version.

We want the data to be sampled randomly but always the same way and we want to be sure that train and test datasets are balanced.

```{r}
# Creating id for partition 
appended_series_set1_selected['id']<- seq.int(nrow(appended_series_set1_selected))
## set the seed to make our partition reproducible
set.seed(123)
# createDataPartition: "the random sampling is done within the levels of y when y is a factor in an attempt to balance the class distributions within the splits."
## 75% of the sample size
train_idx <- createDataPartition(as.factor(appended_series_set1_selected$bact), times = 1, p = 0.75, list=F)
train_set1 <- appended_series_set1_selected[train_idx, ]
test_set1  <- appended_series_set1_selected[-train_idx, ]
#Checking outcome is actually balanced
round(prop.table(table(appended_series_set1_selected$bact)),2)
round(prop.table(table(appended_series_set1_selected$bact)),2)
```

## Separating datasets into outcome and exposures

```{r}
# train dataset
train_X_set1<-train_set1[, names(train_set1)!= "bact"]
train_Y_set1<-train_set1$bact
  
# test dataset
test_X_set1<-test_set1[, names(test_set1)!= "bact"]
test_Y_set1<-test_set1$bact 
```
